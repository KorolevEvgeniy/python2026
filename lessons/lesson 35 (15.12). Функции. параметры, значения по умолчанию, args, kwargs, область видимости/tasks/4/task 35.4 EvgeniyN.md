# Практическое задание 35.4

## Задания

### Описание задачи
В предыдущих блоках ты научился создавать функции, передавать аргументы позиционно и по имени, использовать значения по умолчанию, а также работать с переменным количеством аргументов через `*args` и `**kwargs`. Теперь настало время разобраться с **областью видимости** переменных. Это ключевой механизм, который определяет, где и какую переменную можно использовать или изменить. Понимание области видимости предотвращает множество ошибок, когда переменная оказывается "невидимой" или изменяется не там, где ожидалось.

В этом задании тебе предстоит написать программу, которая моделирует простую систему учета посещений для спортивного зала. Ты будешь работать с **глобальными** и **локальными** переменными, явно управлять доступом к глобальным данным с помощью ключевого слова `global`, а также создашь **замыкание** — функцию, которая "помнит" значения из внешней области видимости. Это позволит тебе на практике интегрировать все изученные концепции функций в единый рабочий сценарий.

**Контекст:** В зале есть общий счетчик всех посещений (`total_visits`). Каждый посетитель имеет свой личный идентификатор и историю своих посещений. Твоя задача — реализовать логику, которая обновляет общую статистику и при этом позволяет работать с персональной статистикой каждого клиента, не смешивая данные.

### Пример входных и выходных данных

**Пример 1: Базовый сценарий**
```python
# Инициализация глобального счетчика
total_visits = 0

# Твой код здесь...

# Создаем функцию для учета посещений конкретного клиента
client_123_tracker = create_visitor_tracker(123)
print(client_123_tracker("Утренняя тренировка"))  # Клиент 123 пришел
print(client_123_tracker("Вечерняя тренировка"))  # Клиент 123 пришел снова

client_456_tracker = create_visitor_tracker(456)
print(client_456_tracker("Йога"))  # Клиент 456 пришел

# Проверяем общую статистику
print(f"Всего посещений зала: {total_visits}")
```
**Ожидаемый вывод:**
```
Клиент 123: Утренняя тренировка. Всего посещений клиента: 1
Клиент 123: Вечерняя тренировка. Всего посещений клиента: 2
Клиент 456: Йога. Всего посещений клиента: 1
Всего посещений зала: 3
```

**Пример 2: Проверка изоляции данных**
```python
total_visits = 5  # Предположим, было 5 посещений до начала работы

tracker_a = create_visitor_tracker(1)
tracker_b = create_visitor_tracker(2)

print(tracker_a("Зал 1"))
print(tracker_b("Зал 2"))
print(tracker_a("Зал 1"))

print(f"Итог: {total_visits}")
```
**Ожидаемый вывод:**
```
Клиент 1: Зал 1. Всего посещений клиента: 1
Клиент 2: Зал 2. Всего посещений клиента: 1
Клиент 1: Зал 1. Всего посещений клиента: 2
Итог: 8
```
*Пояснение:* Изначально `total_visits = 5`. Каждый вызов трекера увеличивает глобальный счетчик на 1. После трех вызовов общее значение становится 8. При этом каждый трекер ведет свой независимый счет.

### Критерии проверки и ограничения
1.  **Глобальная переменная:** Должна существовать глобальная переменная `total_visits`, инициализированная целым числом.
2.  **Функция `create_visitor_tracker`:** Ты должен создать эту функцию. Она принимает один аргумент — `client_id` (идентификатор клиента, число) и возвращает **другую функцию** (внутреннюю).
3.  **Внутренняя функция (замыкание):**
    *   Принимает один аргумент — `activity` (строка, название активности/зала).
    *   При каждом своем вызове должна:
        *   Увеличивать **глобальную** переменную `total_visits` на 1. Используй ключевое слово `global`.
        *   Увеличивать **локальный** для замыкания счетчик посещений именно этого клиента. Этот счетчик должен "жить" между вызовами внутренней функции, созданной для конкретного `client_id`.
        *   Возвращать строку в формате: `"Клиент {client_id}: {activity}. Всего посещений клиента: {personal_count}"`.
4.  **Область видимости:** Не создавай новых глобальных переменных для хранения персональных счетчиков. Они должны быть захвачены замыканием из области видимости внешней функции `create_visitor_tracker`.
5.  **Интеграция:** Программа должна демонстрировать работу с глобальной областью видимости (`global`) и локальной областью видимости замыкания.
6.  **Запрещено:** Использовать классы или любые темы, не входящие в Block 4 (область видимости, локальная/глобальная переменная, global, замыкание, интеграция).

### Решение задачи (псевдокод)
1.  Объяви глобальную переменную `total_visits` и установи ей начальное целочисленное значение.
2.  Определи функцию `create_visitor_tracker`, которая принимает параметр `client_id`.
    1.  Внутри этой функции создай локальную переменную `personal_count` и инициализируй ее нулем. Эта переменная будет доступна внутренней функции.
    2.  Определи внутреннюю функцию (назовем ее `track`), которая принимает параметр `activity`.
        1.  В теле внутренней функции объяви, что переменная `total_visits` является глобальной.
        2.  Увеличь значение глобальной переменной `total_visits` на 1.
        3.  Увеличь значение локальной (для внешней функции) переменной `personal_count` на 1.
        4.  Сформируй и верни результирующую строку, используя `client_id`, `activity` и новое значение `personal_count`.
    3.  Верни внутреннюю функцию `track` как результат работы `create_visitor_tracker`.
3.  Для тестирования создай несколько "трекеров", вызвав `create_visitor_tracker` с разными ID. Каждый вызов вернет свою независимую функцию.
4.  Вызови возвращенные функции несколько раз с разными активностями и выведи результаты.
5.  В конце выведи значение глобальной переменной `total_visits`.

### Рекомендации
-   **Вынести в отдельную функцию:** Основную логику учета посещения действительно стоит вынести в отдельную функцию — это и есть внутренняя функция `track` внутри `create_visitor_tracker`. Она инкапсулирует логику изменения счетчиков и формирования ответа для конкретного клиента.
-   **PEP8:**
    -   Используй осмысленные имена переменных и функций. `create_visitor_tracker`, `client_id`, `activity`, `personal_count` — хорошие примеры.
    -   Следи за отступами. Вложенная функция `track` должна иметь отступ в 4 пробела относительно `def create_visitor_tracker`. Ее тело — еще +4 пробела.
